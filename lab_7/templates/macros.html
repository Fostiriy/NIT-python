<!DOCTYPE html>

<! — Макрос для вывода таблицы без ключевого столбца,
переданного параметром -->
{% macro render_table(table_name, relation, id, len) %}
    <p>
        <b>{{ table_name }}</b>
    </p>
    {% set n = len(relation) %}
    <table>
        <tr>
            {% for name in relation.dtypes.index %}
                {% if name != id %}
                    <th>{{ name }}</th>
                {% endif %}
            {% endfor %}
        </tr>
        <tbody>

        {% for i in range(n) %}
            <tr>
                {% for name in relation.dtypes.index %}
                    {% if name != id %}
                        <td>
                            {% if relation.loc[i, name] == None %}
                                <form action='' method="get">
                                    <input type="hidden" name=return_book_reader_id
                                           value={{ relation.loc[i, "book_reader_id"] }}>
                                    <form action="" method="post">
                                        <input type="submit" value="Сдать">
                                    </form>
                                </form>
                            {% else %}
                                {{ relation.loc[i, name] }}
                            {% endif %}
                        </td>
                    {% endif %}
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endmacro %}

<! — Формирование поля со списком -->
{% macro render_combo_box(combo_box, reader_id, len) %}
    <select name="reader">
        {% set n = len(combo_box) %}
        <!-- формируем строки списка (каждое значение поля
        reader_name - строка списка) в виде
        <option [selected] value = код_читателя> ФИО </option>
        -->
        {% for i in range(n) %}
            {% set id_r = combo_box.loc[i, "reader_id"] %}
            <!-- атрибут value элемента будет совпадать с id читателя -->
            {% if id_r == reader_id %}
                <!-- если код читателя из таблицы совпадает с кодом
                текущего читателя устанавливаем атрибут selected -->
                <option selected value={{ id_r }}>
                    {% else %}
                <option value={{ id_r }}>
            {% endif %}
        {{ combo_box.loc[i, "reader_name"] }}
        </option>
        {% endfor %}
    </select>
{% endmacro %}